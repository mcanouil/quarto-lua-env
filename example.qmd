---
title: "lua-env Example"
subtitle: "Quarto Extension"
author:
  - name: "MickaÃ«l CANOUIL, _Ph.D._"
    orcid: "0000-0002-3396-4549"
    url: "https://mickael.canouil.fr"
format:
  html:
    output-file: index
    toc: true
filters:
  - lua-env
extensions:
  lua-env:
    json: true  # Export metadata to lua-env.json
---

## Introduction

`lua-env` is an extension for [Quarto](https://quarto.org) to provide access to LUA objects as metadata.

This extension gives you access to the `quarto` object and several Pandoc LUA internal objects using shortcodes.

## Installation

```bash
quarto add mcanouil/quarto-lua-env@1.2.1
```

This will install the extension under the `_extensions` subdirectory.

If you're using version control, you will want to check in this directory.

## Usage

Add the following to your YAML header:

- Old (<1.8.21):

  ```yml
  filters:
    - quarto
    - lua-env
  ```

- New (>=1.8.21):

  ```yml
  filters:
    - path: lua-env
      at: post-quarto
  ```

This enables access to LUA objects using two shortcode formats:

- `{{< lua-env quarto.doc.input_file >}}` - Direct access via shortcode.
- `{{< meta lua-env.quarto.doc.input_file >}}` - Access via metadata.

## Available LUA Objects

The following LUA objects are available as metadata:

```yaml
lua-env:
  quarto: "quarto"
  pandoc:
    PANDOC_STATE: "PANDOC_STATE"
    FORMAT: "FORMAT"
    PANDOC_READER_OPTIONS: "PANDOC_READER_OPTIONS"
    PANDOC_WRITER_OPTIONS: "PANDOC_WRITER_OPTIONS"
    PANDOC_VERSION: "PANDOC_VERSION"
    PANDOC_API_VERSION: "PANDOC_API_VERSION"
    PANDOC_SCRIPT_FILE: "PANDOC_SCRIPT_FILE"
```

See [Pandoc LUA API - Global Variables](https://pandoc.org/lua-filters.html#global-variables) for more information about Pandoc global variables.

## Shortcodes

### Quarto

:::: {layout-ncol="2"}

:::: {}

```markdown
{{{< lua-env quarto.doc.input_file >}}}
```

{{< lua-env quarto.doc.input_file >}}

:::

:::: {}

```markdown
{{{< meta lua-env.quarto.doc.input_file >}}}
```

{{< meta lua-env.quarto.doc.input_file >}}

:::
:::

### Pandoc

:::: {layout-ncol="2"}
:::: {}

```markdown
{{{< lua-env pandoc.PANDOC_VERSION >}}}
```

{{< lua-env pandoc.PANDOC_VERSION >}}

:::
:::: {}

```markdown
{{{< meta lua-env.pandoc.PANDOC_VERSION >}}}
```

{{< meta lua-env.pandoc.PANDOC_VERSION >}}

:::
:::

:::: {layout-ncol="2"}
:::: {}

```markdown
{{{< lua-env pandoc.FORMAT >}}}
```

{{< lua-env pandoc.FORMAT >}}

:::
:::: {}

```markdown
{{{< meta lua-env.pandoc.FORMAT >}}}
```

{{< meta lua-env.pandoc.FORMAT >}}

:::
:::

## JSON Export

This document is configured to export the `lua-env` metadata to a JSON file.

By default, no JSON file is written (`json: false`). To enable JSON export, set `json: true` or provide a custom file path.

The YAML header includes:

```yaml
extensions:
  lua-env:
    json: true  # Export metadata to lua-env.json
```

This will create a file named `lua-env.json` in the same directory as this document, containing all the LUA environment metadata collected during rendering.

You can also specify a custom file path:

```yaml
extensions:
  lua-env:
    json: "custom-output.json"
```
